---
id: 50
title: Cluster Maintenance
category: CKA
duration: 45 mins
---

# Cluster Maintenance

Keeping the lights on.

# Task 1: Drain Node
Drain `node-1` for maintenance.

```bash
kubectl drain node-1 --ignore-daemonsets --force
```

```setup
kubectl uncordon node-1 2>/dev/null || true
```

```verify
kubectl get node node-1 --no-headers | grep SchedulingDisabled
```

# Task 2: Upgrade kubeadm
Upgrade `kubeadm` to version `1.27.0`.

```bash
apt-get update && apt-get install -y kubeadm=1.27.0-00
```

```setup
echo "Ready"
```

```verify
kubeadm version | grep 1.27.0
```

# Task 3: Etcd Snapshot
Take a snapshot of etcd.

```bash
ETCDCTL_API=3 etcdctl --endpoints=https://127.0.0.1:2379 \
  --cacert=/etc/kubernetes/pki/etcd/ca.crt \
  --cert=/etc/kubernetes/pki/etcd/server.crt \
  --key=/etc/kubernetes/pki/etcd/server.key \
  snapshot save /tmp/etcd-backup.db
```

```setup
echo "Ready"
```

```verify
ls /tmp/etcd-backup.db > /dev/null
```
