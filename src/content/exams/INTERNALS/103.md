---
id: 103
title: The Controller Pattern
category: INTERNALS
duration: 70 mins
---

# The Controller Pattern & Reconciliation Loop

Kubernetes is a system of **eventually consistent** control loops.

## The Loop
1.  **Observe**: Watch the current state (via API Server).
2.  **Diff**: Compare against desired state (Spec).
3.  **Act**: Make changes to move closer to desired state.

## Under the Hood (client-go)
How does a controller actually work?
1.  **Reflector**: Watches the API and puts objects in a localized Queue (`DeltaFIFO`).
2.  **Informer**: Reads from Queue and updates the **Local Store (Cache)**. This avoids hammering the API server.
3.  **Workqueue**: When an object changes, its key (e.g., `default/my-pod`) is added here.
4.  **Reconciler**: The worker logic that pops the key and does the business logic.

> [!NOTE]
> This is why "Level Triggered" logic is preferred over "Edge Triggered". If you miss an event, you just reconcile the current state next time.
