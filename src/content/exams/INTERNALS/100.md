---
id: 100
title: "Service Internals: Iptables vs IPVS"
category: INTERNALS
duration: 60 mins
---

# Service Implementation: Deep Dive

How does a Service IP (ClusterIP) actually work? It's virtual! It doesn't exist on any interface.

## kube-proxy
The component responsible for watching the API Server for Services/Endpoints and configuring rules.

## Iptables Mode (Default)
Traffic is captured by PREROUTING/OUTPUT chains and redirected.
- **Chain KUBE-SERVICES**: The entry point.
- **Chain KUBE-SVC-***: Round-robin load balancing (using statistic mode random probability).
- **Chain KUBE-SEP-***: Service EndPoint (DNAT to actual Pod IP).

# Task 1: Inspect Service Rules
View the KUBE-SERVICES chain in iptables to see how ClusterIPs are handled.

```bash
sudo iptables -t nat -L KUBE-SERVICES | head -n 20
```

```setup
echo "Ready"
```

```verify
sudo iptables -t nat -L KUBE-SERVICES > /dev/null
```

## IPVS Mode
Uses Linux Kernel's IP Virtual Server (Netfilter).
- **Performance**: O(1) matching vs O(n) for iptables (sequential scan).
- **Scalability**: Better for thousands of services.
